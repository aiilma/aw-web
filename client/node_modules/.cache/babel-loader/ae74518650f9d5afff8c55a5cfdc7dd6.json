{"ast":null,"code":"import{fetch}from\"../utils\";var baseUrl=typeof document===\"undefined\"?\"http://localhost:8000/api\":\"/api\";var apiService=function apiService(){return function(next){return function(action){var result=next(action);if(!action.meta||!action.meta.async){return result;}var _action$meta=action.meta,path=_action$meta.path,_action$meta$method=_action$meta.method,method=_action$meta$method===void 0?\"GET\":_action$meta$method,body=_action$meta.body;if(!path){throw new Error(\"'path' not specified for async action \".concat(action.type));}var url=\"\".concat(baseUrl).concat(path);return fetch(url,method,body).then(function(res){return handleResponse(res,action,next);},function(err){return handleErrors(err,action,next);});};};};export default apiService;function handleErrors(err,action,next){next({type:\"\".concat(action.type,\"_FAILED\"),payload:err,meta:action.meta});return Promise.reject(err);}function handleResponse(res,action,next){next({type:\"\".concat(action.type,\"_COMPLETED\"),payload:res,meta:action.meta});return res;}","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/middlewares/apiService.js"],"names":["fetch","baseUrl","document","apiService","next","action","result","meta","async","path","method","body","Error","type","url","then","res","handleResponse","err","handleErrors","payload","Promise","reject"],"mappings":"AAAA,OAAQA,KAAR,KAAoB,UAApB,CAEA,GAAMC,CAAAA,OAAO,CAAG,MAAOC,CAAAA,QAAP,GAAoB,WAApB,CAAkC,2BAAlC,CAAgE,MAAhF,CAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAM,UAACC,IAAD,QAAU,UAACC,MAAD,CAAY,CAC3C,GAAMC,CAAAA,MAAM,CAAGF,IAAI,CAACC,MAAD,CAAnB,CACA,GAAI,CAACA,MAAM,CAACE,IAAR,EAAgB,CAACF,MAAM,CAACE,IAAP,CAAYC,KAAjC,CAAwC,CACpC,MAAOF,CAAAA,MAAP,CACH,CAJ0C,iBAMND,MAAM,CAACE,IAND,CAMpCE,IANoC,cAMpCA,IANoC,kCAM9BC,MAN8B,CAM9BA,MAN8B,8BAMrB,KANqB,qBAMdC,IANc,cAMdA,IANc,CAQ3C,GAAI,CAACF,IAAL,CAAW,CACP,KAAM,IAAIG,CAAAA,KAAJ,iDAAmDP,MAAM,CAACQ,IAA1D,EAAN,CACH,CAED,GAAMC,CAAAA,GAAG,WAAMb,OAAN,SAAgBQ,IAAhB,CAAT,CAEA,MAAOT,CAAAA,KAAK,CAACc,GAAD,CAAMJ,MAAN,CAAcC,IAAd,CAAL,CAAyBI,IAAzB,CACH,SAAAC,GAAG,QAAIC,CAAAA,cAAc,CAACD,GAAD,CAAMX,MAAN,CAAcD,IAAd,CAAlB,EADA,CAEH,SAAAc,GAAG,QAAIC,CAAAA,YAAY,CAACD,GAAD,CAAMb,MAAN,CAAcD,IAAd,CAAhB,EAFA,CAAP,CAIH,CAlBwB,EAAN,EAAnB,CAoBA,cAAeD,CAAAA,UAAf,CAEA,QAASgB,CAAAA,YAAT,CAAsBD,GAAtB,CAA2Bb,MAA3B,CAAmCD,IAAnC,CAAyC,CAErCA,IAAI,CAAC,CACDS,IAAI,WAAKR,MAAM,CAACQ,IAAZ,WADH,CAEDO,OAAO,CAAEF,GAFR,CAGDX,IAAI,CAAEF,MAAM,CAACE,IAHZ,CAAD,CAAJ,CAMA,MAAOc,CAAAA,OAAO,CAACC,MAAR,CAAeJ,GAAf,CAAP,CACH,CAED,QAASD,CAAAA,cAAT,CAAwBD,GAAxB,CAA6BX,MAA7B,CAAqCD,IAArC,CAA2C,CACvCA,IAAI,CAAC,CACDS,IAAI,WAAKR,MAAM,CAACQ,IAAZ,cADH,CAEDO,OAAO,CAAEJ,GAFR,CAGDT,IAAI,CAAEF,MAAM,CAACE,IAHZ,CAAD,CAAJ,CAMA,MAAOS,CAAAA,GAAP,CACH","sourcesContent":["import {fetch} from \"../utils\";\r\n\r\nconst baseUrl = typeof document === \"undefined\" ? \"http://localhost:8000/api\" : \"/api\";\r\n\r\nconst apiService = () => (next) => (action) => {\r\n    const result = next(action);\r\n    if (!action.meta || !action.meta.async) {\r\n        return result;\r\n    }\r\n\r\n    const {path, method = \"GET\", body} = action.meta;\r\n\r\n    if (!path) {\r\n        throw new Error(`'path' not specified for async action ${action.type}`);\r\n    }\r\n\r\n    const url = `${baseUrl}${path}`;\r\n\r\n    return fetch(url, method, body).then(\r\n        res => handleResponse(res, action, next),\r\n        err => handleErrors(err, action, next),\r\n    );\r\n};\r\n\r\nexport default apiService;\r\n\r\nfunction handleErrors(err, action, next) {\r\n\r\n    next({\r\n        type: `${action.type}_FAILED`,\r\n        payload: err,\r\n        meta: action.meta,\r\n    });\r\n\r\n    return Promise.reject(err);\r\n}\r\n\r\nfunction handleResponse(res, action, next) {\r\n    next({\r\n        type: `${action.type}_COMPLETED`,\r\n        payload: res,\r\n        meta: action.meta,\r\n    });\r\n\r\n    return res;\r\n}"]},"metadata":{},"sourceType":"module"}