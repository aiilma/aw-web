{"ast":null,"code":"import { authLogin, authLogout, authLoginCompleted, authLogoutCompleted, authLoginFailed } from \"./actions\";\nimport { fetch } from \"../../utils\";\nimport { handleHTTPError } from \"../error/operations\";\nimport UserApi from \"../../utils/UserApi\";\nimport history from \"../../utils/history\";\n\nconst login = params => dispatch => {\n  dispatch(authLogin());\n  return fetch(`/airlock/csrf-cookie`, \"GET\").then(() => {\n    fetch(`/api/login/steam/callback${params}`, \"GET\").then(user => {\n      UserApi.authenticate(dispatch(authLoginCompleted(user)));\n    }).catch(err => {\n      dispatch(authLoginFailed());\n      dispatch(handleHTTPError(err));\n    });\n  }).catch(err => {\n    dispatch(authLoginFailed());\n    dispatch(handleHTTPError(err));\n  });\n};\n\nconst logout = () => dispatch => {\n  dispatch(authLogout());\n  return fetch(`/api/logout`, \"POST\").then(res => {\n    UserApi.logout(() => {\n      dispatch(authLogoutCompleted());\n      history.push('/');\n    });\n  }).catch(err => {\n    dispatch(handleHTTPError(err));\n  });\n};\n\nconst me = () => dispatch => {\n  dispatch(authLogin());\n  return fetch(`/api/user`, \"GET\").then(response => {\n    UserApi.authenticate(dispatch(authLoginCompleted(response)));\n    return response;\n  }).catch(err => {\n    // dispatch(logout())\n    dispatch(handleHTTPError(err));\n  });\n};\n\nexport { login, logout, me };","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/ducks/auth/operations.js"],"names":["authLogin","authLogout","authLoginCompleted","authLogoutCompleted","authLoginFailed","fetch","handleHTTPError","UserApi","history","login","params","dispatch","then","user","authenticate","catch","err","logout","res","push","me","response"],"mappings":"AAAA,SACIA,SADJ,EAEIC,UAFJ,EAGIC,kBAHJ,EAIIC,mBAJJ,EAKIC,eALJ,QAMO,WANP;AAOA,SAAQC,KAAR,QAAoB,aAApB;AACA,SAAQC,eAAR,QAA8B,qBAA9B;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,OAAP,MAAoB,qBAApB;;AAEA,MAAMC,KAAK,GAAIC,MAAD,IAAaC,QAAD,IAAc;AACpCA,EAAAA,QAAQ,CAACX,SAAS,EAAV,CAAR;AACA,SAAOK,KAAK,CAAE,sBAAF,EAAyB,KAAzB,CAAL,CACFO,IADE,CACG,MAAM;AACRP,IAAAA,KAAK,CAAE,4BAA2BK,MAAO,EAApC,EAAuC,KAAvC,CAAL,CACKE,IADL,CACWC,IAAD,IAAU;AACZN,MAAAA,OAAO,CAACO,YAAR,CAAqBH,QAAQ,CAACT,kBAAkB,CAACW,IAAD,CAAnB,CAA7B;AACH,KAHL,EAIKE,KAJL,CAIYC,GAAD,IAAS;AACZL,MAAAA,QAAQ,CAACP,eAAe,EAAhB,CAAR;AACAO,MAAAA,QAAQ,CAACL,eAAe,CAACU,GAAD,CAAhB,CAAR;AACH,KAPL;AAQH,GAVE,EAWFD,KAXE,CAWIC,GAAG,IAAI;AACVL,IAAAA,QAAQ,CAACP,eAAe,EAAhB,CAAR;AACAO,IAAAA,QAAQ,CAACL,eAAe,CAACU,GAAD,CAAhB,CAAR;AACH,GAdE,CAAP;AAeH,CAjBD;;AAmBA,MAAMC,MAAM,GAAG,MAAMN,QAAQ,IAAI;AAC7BA,EAAAA,QAAQ,CAACV,UAAU,EAAX,CAAR;AACA,SAAOI,KAAK,CAAE,aAAF,EAAgB,MAAhB,CAAL,CACFO,IADE,CACIM,GAAD,IAAS;AACXX,IAAAA,OAAO,CAACU,MAAR,CAAe,MAAM;AACjBN,MAAAA,QAAQ,CAACR,mBAAmB,EAApB,CAAR;AACAK,MAAAA,OAAO,CAACW,IAAR,CAAa,GAAb;AACH,KAHD;AAIH,GANE,EAOFJ,KAPE,CAOIC,GAAG,IAAI;AACVL,IAAAA,QAAQ,CAACL,eAAe,CAACU,GAAD,CAAhB,CAAR;AACH,GATE,CAAP;AAUH,CAZD;;AAcA,MAAMI,EAAE,GAAG,MAAMT,QAAQ,IAAI;AACzBA,EAAAA,QAAQ,CAACX,SAAS,EAAV,CAAR;AACA,SAAOK,KAAK,CAAE,WAAF,EAAc,KAAd,CAAL,CACFO,IADE,CACIS,QAAD,IAAc;AAChBd,IAAAA,OAAO,CAACO,YAAR,CAAqBH,QAAQ,CAACT,kBAAkB,CAACmB,QAAD,CAAnB,CAA7B;AACA,WAAOA,QAAP;AACH,GAJE,EAKFN,KALE,CAKKC,GAAD,IAAS;AACZ;AACAL,IAAAA,QAAQ,CAACL,eAAe,CAACU,GAAD,CAAhB,CAAR;AACH,GARE,CAAP;AASH,CAXD;;AAcA,SACIP,KADJ,EACWQ,MADX,EACmBG,EADnB","sourcesContent":["import {\r\n    authLogin,\r\n    authLogout,\r\n    authLoginCompleted,\r\n    authLogoutCompleted,\r\n    authLoginFailed,\r\n} from \"./actions\";\r\nimport {fetch} from \"../../utils\";\r\nimport {handleHTTPError} from \"../error/operations\";\r\nimport UserApi from \"../../utils/UserApi\";\r\nimport history from \"../../utils/history\";\r\n\r\nconst login = (params) => (dispatch) => {\r\n    dispatch(authLogin())\r\n    return fetch(`/airlock/csrf-cookie`, \"GET\")\r\n        .then(() => {\r\n            fetch(`/api/login/steam/callback${params}`, \"GET\")\r\n                .then((user) => {\r\n                    UserApi.authenticate(dispatch(authLoginCompleted(user)))\r\n                })\r\n                .catch((err) => {\r\n                    dispatch(authLoginFailed())\r\n                    dispatch(handleHTTPError(err))\r\n                });\r\n        })\r\n        .catch(err => {\r\n            dispatch(authLoginFailed())\r\n            dispatch(handleHTTPError(err))\r\n        });\r\n}\r\n\r\nconst logout = () => dispatch => {\r\n    dispatch(authLogout())\r\n    return fetch(`/api/logout`, \"POST\")\r\n        .then((res) => {\r\n            UserApi.logout(() => {\r\n                dispatch(authLogoutCompleted())\r\n                history.push('/')\r\n            })\r\n        })\r\n        .catch(err => {\r\n            dispatch(handleHTTPError(err))\r\n        });\r\n}\r\n\r\nconst me = () => dispatch => {\r\n    dispatch(authLogin())\r\n    return fetch(`/api/user`, \"GET\")\r\n        .then((response) => {\r\n            UserApi.authenticate(dispatch(authLoginCompleted(response)))\r\n            return response\r\n        })\r\n        .catch((err) => {\r\n            // dispatch(logout())\r\n            dispatch(handleHTTPError(err))\r\n        });\r\n}\r\n\r\n\r\nexport {\r\n    login, logout, me\r\n}"]},"metadata":{},"sourceType":"module"}