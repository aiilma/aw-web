{"ast":null,"code":"import axios from 'axios';\nimport store from '../store';\nimport { logout } from \"../ducks/auth/operations\";\naxios.defaults.headers.common[\"X-Requested-With\"] = \"XMLHttpRequest\";\naxios.defaults.withCredentials = true;\naxios.defaults.baseURL = process.env.REACT_APP_API;\n\nconst fetch = (url, method, body) => {\n  const options = {\n    method,\n    headers: requestHeaders()\n  }; // console.log(body)\n\n  if (method === \"POST\") {\n    return axios.post(url, JSON.stringify(body), options).then(res => parseStatus(res.status, res.data)).catch(err => parseStatus(err.response.status, err.response.data));\n  }\n\n  if (method === \"GET\") {\n    return axios.get(url, options).then(res => parseStatus(res.status, res.data), err => parseStatus(err.response.status, err.response.data)).catch(err => {\n      if (err.status === 401) {\n        store.dispatch(logout());\n      }\n\n      return Promise.reject(err);\n    });\n  }\n};\n\nexport default fetch;\n\nfunction parseStatus(status, res) {\n  return new Promise((resolve, reject) => {\n    if (status >= 200 && status < 300) {\n      resolve(res);\n    } else {\n      reject({\n        status,\n        message: res.message\n      });\n    }\n  });\n}\n\nfunction requestHeaders() {\n  const headers = {\n    \"Accept\": \"application/json\",\n    \"Content-Type\": \"application/json\"\n  }; // let token = document.head.querySelector('meta[name=\"csrf-token\"]');\n  // if (!!token) {\n  //     headers['X-CSRF-TOKEN'] = token.content;\n  // }\n\n  return headers;\n}","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/utils/fetch.js"],"names":["axios","store","logout","defaults","headers","common","withCredentials","baseURL","process","env","REACT_APP_API","fetch","url","method","body","options","requestHeaders","post","JSON","stringify","then","res","parseStatus","status","data","catch","err","response","get","dispatch","Promise","reject","resolve","message"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,SAAQC,MAAR,QAAqB,0BAArB;AAEAF,KAAK,CAACG,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,kBAA9B,IAAoD,gBAApD;AACAL,KAAK,CAACG,QAAN,CAAeG,eAAf,GAAiC,IAAjC;AACAN,KAAK,CAACG,QAAN,CAAeI,OAAf,GAAyBC,OAAO,CAACC,GAAR,CAAYC,aAArC;;AAEA,MAAMC,KAAK,GAAG,CAACC,GAAD,EAAMC,MAAN,EAAcC,IAAd,KAAuB;AAEjC,QAAMC,OAAO,GAAG;AACZF,IAAAA,MADY;AAEZT,IAAAA,OAAO,EAAEY,cAAc;AAFX,GAAhB,CAFiC,CAMjC;;AAEA,MAAIH,MAAM,KAAK,MAAf,EAAuB;AACnB,WAAOb,KAAK,CAACiB,IAAN,CAAWL,GAAX,EAAgBM,IAAI,CAACC,SAAL,CAAeL,IAAf,CAAhB,EAAsCC,OAAtC,EACFK,IADE,CACGC,GAAG,IAAIC,WAAW,CAACD,GAAG,CAACE,MAAL,EAAaF,GAAG,CAACG,IAAjB,CADrB,EAEFC,KAFE,CAEIC,GAAG,IAAIJ,WAAW,CAACI,GAAG,CAACC,QAAJ,CAAaJ,MAAd,EAAsBG,GAAG,CAACC,QAAJ,CAAaH,IAAnC,CAFtB,CAAP;AAGH;;AACD,MAAIX,MAAM,KAAK,KAAf,EAAsB;AAClB,WAAOb,KAAK,CAAC4B,GAAN,CAAUhB,GAAV,EAAeG,OAAf,EACFK,IADE,CACGC,GAAG,IAAIC,WAAW,CAACD,GAAG,CAACE,MAAL,EAAaF,GAAG,CAACG,IAAjB,CADrB,EAC6CE,GAAG,IAAIJ,WAAW,CAACI,GAAG,CAACC,QAAJ,CAAaJ,MAAd,EAAsBG,GAAG,CAACC,QAAJ,CAAaH,IAAnC,CAD/D,EAEFC,KAFE,CAEKC,GAAD,IAAS;AACZ,UAAIA,GAAG,CAACH,MAAJ,KAAe,GAAnB,EAAwB;AACpBtB,QAAAA,KAAK,CAAC4B,QAAN,CAAe3B,MAAM,EAArB;AACH;;AACD,aAAO4B,OAAO,CAACC,MAAR,CAAeL,GAAf,CAAP;AACH,KAPE,CAAP;AAQH;AACJ,CAvBD;;AAyBA,eAAef,KAAf;;AAEA,SAASW,WAAT,CAAqBC,MAArB,EAA6BF,GAA7B,EAAkC;AAC9B,SAAO,IAAIS,OAAJ,CAAY,CAACE,OAAD,EAAUD,MAAV,KAAqB;AACpC,QAAIR,MAAM,IAAI,GAAV,IAAiBA,MAAM,GAAG,GAA9B,EAAmC;AAC/BS,MAAAA,OAAO,CAACX,GAAD,CAAP;AACH,KAFD,MAEO;AACHU,MAAAA,MAAM,CAAC;AAACR,QAAAA,MAAD;AAASU,QAAAA,OAAO,EAAEZ,GAAG,CAACY;AAAtB,OAAD,CAAN;AACH;AACJ,GANM,CAAP;AAOH;;AAED,SAASjB,cAAT,GAA0B;AACtB,QAAMZ,OAAO,GAAG;AACZ,cAAU,kBADE;AAEZ,oBAAgB;AAFJ,GAAhB,CADsB,CAMtB;AACA;AACA;AACA;;AAEA,SAAOA,OAAP;AACH","sourcesContent":["import axios from 'axios'\r\nimport store from '../store'\r\nimport {logout} from \"../ducks/auth/operations\";\r\n\r\naxios.defaults.headers.common[\"X-Requested-With\"] = \"XMLHttpRequest\";\r\naxios.defaults.withCredentials = true;\r\naxios.defaults.baseURL = process.env.REACT_APP_API;\r\n\r\nconst fetch = (url, method, body) => {\r\n\r\n    const options = {\r\n        method,\r\n        headers: requestHeaders(),\r\n    };\r\n    // console.log(body)\r\n\r\n    if (method === \"POST\") {\r\n        return axios.post(url, JSON.stringify(body), options)\r\n            .then(res => parseStatus(res.status, res.data))\r\n            .catch(err => parseStatus(err.response.status, err.response.data))\r\n    }\r\n    if (method === \"GET\") {\r\n        return axios.get(url, options)\r\n            .then(res => parseStatus(res.status, res.data), err => parseStatus(err.response.status, err.response.data))\r\n            .catch((err) => {\r\n                if (err.status === 401) {\r\n                    store.dispatch(logout())\r\n                }\r\n                return Promise.reject(err)\r\n            })\r\n    }\r\n};\r\n\r\nexport default fetch\r\n\r\nfunction parseStatus(status, res) {\r\n    return new Promise((resolve, reject) => {\r\n        if (status >= 200 && status < 300) {\r\n            resolve(res);\r\n        } else {\r\n            reject({status, message: res.message});\r\n        }\r\n    });\r\n}\r\n\r\nfunction requestHeaders() {\r\n    const headers = {\r\n        \"Accept\": \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n    }\r\n\r\n    // let token = document.head.querySelector('meta[name=\"csrf-token\"]');\r\n    // if (!!token) {\r\n    //     headers['X-CSRF-TOKEN'] = token.content;\r\n    // }\r\n\r\n    return headers\r\n}"]},"metadata":{},"sourceType":"module"}