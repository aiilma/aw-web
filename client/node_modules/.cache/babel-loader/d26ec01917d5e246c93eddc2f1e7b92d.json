{"ast":null,"code":"import _objectSpread from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.server\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{withRouter}from\"react-router-dom\";import CompList from\"./CompList\";import{connect}from\"react-redux\";import SecondaryLayout from\"../../layout/SecondaryLayout\";import{fetchList,clearList}from\"../../../store/ducks/comp-list/operations\";import queryString from'query-string';import{ContentWrapper,PageCaption,Pagination,Preloader}from\"../../common/layout\";import{handleHTTPError,resetHTTPError}from\"../../../store/ducks/error/operations\";import Alert from\"@material-ui/lab/Alert\";var CompositionsContainer=/*#__PURE__*/function(_Component){_inherits(CompositionsContainer,_Component);function CompositionsContainer(props){var _this;_classCallCheck(this,CompositionsContainer);_this=_possibleConstructorReturn(this,_getPrototypeOf(CompositionsContainer).call(this,props));_this.state={currentPage:null,total:null,perPage:null,countPages:null};_this.loadCompositions=_this.loadCompositions.bind(_assertThisInitialized(_this));return _this;}_createClass(CompositionsContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props=this.props,compositions=_this$props.compositions,location=_this$props.location;if(compositions.length===0){var search=queryString.parse(location.search);if(!(+search.page>0))search.page=1;this.loadCompositions(null,search.page);// const uri = queryString.stringifyUrl({url: location.pathname, query: search});\n// console.log(uri)\n}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.props.compositions.length>0){this.props.clearList();}this.props.resetHTTPError();}},{key:\"loadCompositions\",value:function loadCompositions(e,to){var _this2=this;var _this$props2=this.props,location=_this$props2.location,fetchList=_this$props2.fetchList,handleHTTPError=_this$props2.handleHTTPError;var uri=queryString.stringifyUrl({url:location.pathname,query:{page:to}});return fetchList(uri).then(function(res){var current_page=res.current_page,per_page=res.per_page,total=res.total;_this2.setState(_objectSpread({},_this2.state,{currentPage:current_page,perPage:per_page,total:total,countPages:Math.ceil(total/per_page)}));}).catch(function(err){return handleHTTPError(err);});}},{key:\"render\",value:function render(){var _this$state=this.state,countPages=_this$state.countPages,currentPage=_this$state.currentPage;var pagerNode=React.createElement(Pagination,{countPages:countPages,count:countPages,onChange:this.loadCompositions,page:currentPage});return React.createElement(SecondaryLayout,null,React.createElement(PageCaption,{title:\"Compositions\"}),React.createElement(ContentWrapper,null,pagerNode,this.props.error.isError?React.createElement(Alert,{severity:\"error\"},this.props.error.message):this.props.isFetching?React.createElement(Preloader,null):this.props.compositions.length>0?React.createElement(CompList,{compositions:this.props.compositions}):React.createElement(Alert,{severity:\"info\"},\"List is empty\"),pagerNode));}}]);return CompositionsContainer;}(Component);var mapStateToProps=function mapStateToProps(state){return{compositions:state.compList.compositions,isFetching:state.compList.isFetching,error:state.error};};export default connect(mapStateToProps,{fetchList:fetchList,clearList:clearList,handleHTTPError:handleHTTPError,resetHTTPError:resetHTTPError})(withRouter(CompositionsContainer));","map":null,"metadata":{},"sourceType":"module"}