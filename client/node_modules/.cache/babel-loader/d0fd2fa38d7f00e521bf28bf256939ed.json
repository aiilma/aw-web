{"ast":null,"code":"import { authLogin, authLogout, authMe, authRefreshToken } from \"./actions\";\nimport { fetch } from \"../../utils\";\n\nconst login = response => dispatch => {\n  return new Promise((resolve, reject) => {\n    if (response.success) {\n      const creds = response.data;\n      dispatch(authLogin(creds));\n      return resolve();\n    } else {\n      return reject();\n    }\n  });\n};\n\nconst logout = () => dispatch => {\n  return fetch('/api/auth/logout', \"POST\").then(() => {\n    dispatch(authLogout());\n  });\n};\n\nconst me = () => dispatch => {\n  return fetch('/api/auth/me', \"POST\").then(user => {\n    dispatch(authMe(user));\n  }).catch(err => {\n    console.error(err);\n  });\n};\n\nconst refresh = token => (dispatch, getState) => {\n  if (!!token && !getState().auth.isAuthenticated) {\n    return fetch('/api/auth/refresh', \"POST\").then(() => {\n      dispatch(authRefreshToken());\n    }); // если данные о пользователе в стейте, тогда запрос за новым токеном (в теле - старый),\n  } else {\n    return logout();\n  }\n};\n\nexport { login, logout, me, refresh };","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/ducks/auth/operations.js"],"names":["authLogin","authLogout","authMe","authRefreshToken","fetch","login","response","dispatch","Promise","resolve","reject","success","creds","data","logout","then","me","user","catch","err","console","error","refresh","token","getState","auth","isAuthenticated"],"mappings":"AAAA,SAAQA,SAAR,EAAmBC,UAAnB,EAA+BC,MAA/B,EAAuCC,gBAAvC,QAA8D,WAA9D;AACA,SAAQC,KAAR,QAAoB,aAApB;;AAEA,MAAMC,KAAK,GAAGC,QAAQ,IAAIC,QAAQ,IAAI;AAClC,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,QAAIJ,QAAQ,CAACK,OAAb,EAAsB;AAAA,YACLC,KADK,GACIN,QADJ,CACXO,IADW;AAElBN,MAAAA,QAAQ,CAACP,SAAS,CAACY,KAAD,CAAV,CAAR;AACA,aAAOH,OAAO,EAAd;AACH,KAJD,MAIO;AACH,aAAOC,MAAM,EAAb;AACH;AACJ,GARM,CAAP;AASH,CAVD;;AAYA,MAAMI,MAAM,GAAG,MAAMP,QAAQ,IAAI;AAC7B,SAAOH,KAAK,CAAC,kBAAD,EAAqB,MAArB,CAAL,CAAkCW,IAAlC,CAAuC,MAAM;AAChDR,IAAAA,QAAQ,CAACN,UAAU,EAAX,CAAR;AACH,GAFM,CAAP;AAGH,CAJD;;AAMA,MAAMe,EAAE,GAAG,MAAMT,QAAQ,IAAI;AACzB,SAAOH,KAAK,CAAC,cAAD,EAAiB,MAAjB,CAAL,CACFW,IADE,CACIE,IAAD,IAAU;AACZV,IAAAA,QAAQ,CAACL,MAAM,CAACe,IAAD,CAAP,CAAR;AACH,GAHE,EAIFC,KAJE,CAIIC,GAAG,IAAI;AACVC,IAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACH,GANE,CAAP;AAOH,CARD;;AAUA,MAAMG,OAAO,GAAIC,KAAD,IAAW,CAAChB,QAAD,EAAWiB,QAAX,KAAwB;AAC/C,MAAI,CAAC,CAACD,KAAF,IAAW,CAACC,QAAQ,GAAGC,IAAX,CAAgBC,eAAhC,EAAiD;AAC7C,WAAOtB,KAAK,CAAC,mBAAD,EAAsB,MAAtB,CAAL,CAAmCW,IAAnC,CAAwC,MAAM;AACjDR,MAAAA,QAAQ,CAACJ,gBAAgB,EAAjB,CAAR;AACH,KAFM,CAAP,CAD6C,CAI7C;AACH,GALD,MAKO;AACH,WAAOW,MAAM,EAAb;AACH;AACJ,CATD;;AAWA,SACIT,KADJ,EACWS,MADX,EACmBE,EADnB,EACuBM,OADvB","sourcesContent":["import {authLogin, authLogout, authMe, authRefreshToken} from \"./actions\";\r\nimport {fetch} from \"../../utils\";\r\n\r\nconst login = response => dispatch => {\r\n    return new Promise((resolve, reject) => {\r\n        if (response.success) {\r\n            const {data: creds} = response\r\n            dispatch(authLogin(creds));\r\n            return resolve()\r\n        } else {\r\n            return reject()\r\n        }\r\n    })\r\n}\r\n\r\nconst logout = () => dispatch => {\r\n    return fetch('/api/auth/logout', \"POST\").then(() => {\r\n        dispatch(authLogout())\r\n    })\r\n}\r\n\r\nconst me = () => dispatch => {\r\n    return fetch('/api/auth/me', \"POST\")\r\n        .then((user) => {\r\n            dispatch(authMe(user))\r\n        })\r\n        .catch(err => {\r\n            console.error(err)\r\n        })\r\n}\r\n\r\nconst refresh = (token) => (dispatch, getState) => {\r\n    if (!!token && !getState().auth.isAuthenticated) {\r\n        return fetch('/api/auth/refresh', \"POST\").then(() => {\r\n            dispatch(authRefreshToken())\r\n        })\r\n        // если данные о пользователе в стейте, тогда запрос за новым токеном (в теле - старый),\r\n    } else {\r\n        return logout()\r\n    }\r\n}\r\n\r\nexport {\r\n    login, logout, me, refresh\r\n}"]},"metadata":{},"sourceType":"module"}