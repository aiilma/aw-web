{"ast":null,"code":"import _objectSpread from \"D:\\\\Projects\\\\php\\\\Laravel\\\\aw.client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport RAvatar from \"../../assets/img/my_avatar.jpg\";\nimport { AxiosInstance as Http } from \"axios\";\nexport const AUTH_LOGIN = 'AUTH_LOGIN';\nexport const AUTH_CHECK = 'AUTH_CHECK';\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT';\nconst user = {\n  user_id: null,\n  steamid: null,\n  nickname: null,\n  avatar: null,\n  balance: null,\n  group: null,\n  registered_at: null,\n  visited_at: null\n};\nconst initialState = {\n  isAuthenticated: false,\n  isAdmin: false,\n  user\n};\nexport const authReducer = (state = initialState, {\n  type,\n  payload = null\n}) => {\n  switch (type) {\n    case AUTH_LOGIN:\n      return authLogin(state, payload);\n\n    case AUTH_CHECK:\n      return checkAuth(state);\n\n    case AUTH_LOGOUT:\n      return logout(state);\n\n    default:\n      return state;\n  }\n};\n\nconst authLogin = (state, payload) => {\n  const jwtToken = payload.token;\n  const user = payload.user[0];\n  localStorage.setItem('jwt_token', jwtToken);\n  Http.defaults.headers.common['Authorization'] = `Bearer ${jwtToken}`;\n  return _objectSpread({}, state, {\n    isAuthenticated: true,\n    user\n  });\n};\n\nconst checkAuth = state => {\n  state = _objectSpread({}, state, {\n    isAuthenticated: !!localStorage.getItem('jwt_token')\n  });\n\n  if (state.isAuthenticated) {\n    Http.defaults.headers.common['Authorization'] = `Bearer ${localStorage.getItem('jwt_token')}`;\n  }\n\n  return state;\n};\n\nconst logout = state => {\n  localStorage.removeItem('jwt_token');\n  return _objectSpread({}, state, {\n    isAuthenticated: false,\n    user\n  });\n};","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/reducers/auth.js"],"names":["RAvatar","AxiosInstance","Http","AUTH_LOGIN","AUTH_CHECK","AUTH_LOGOUT","user","user_id","steamid","nickname","avatar","balance","group","registered_at","visited_at","initialState","isAuthenticated","isAdmin","authReducer","state","type","payload","authLogin","checkAuth","logout","jwtToken","token","localStorage","setItem","defaults","headers","common","getItem","removeItem"],"mappings":";AAAA,OAAOA,OAAP,MAAoB,gCAApB;AACA,SAAQC,aAAa,IAAIC,IAAzB,QAAoC,OAApC;AACA,OAAO,MAAMC,UAAU,GAAG,YAAnB;AACP,OAAO,MAAMC,UAAU,GAAG,YAAnB;AACP,OAAO,MAAMC,WAAW,GAAG,aAApB;AAEP,MAAMC,IAAI,GAAG;AACTC,EAAAA,OAAO,EAAE,IADA;AAETC,EAAAA,OAAO,EAAE,IAFA;AAGTC,EAAAA,QAAQ,EAAE,IAHD;AAITC,EAAAA,MAAM,EAAE,IAJC;AAKTC,EAAAA,OAAO,EAAE,IALA;AAMTC,EAAAA,KAAK,EAAE,IANE;AAOTC,EAAAA,aAAa,EAAE,IAPN;AAQTC,EAAAA,UAAU,EAAE;AARH,CAAb;AAWA,MAAMC,YAAY,GAAG;AACjBC,EAAAA,eAAe,EAAE,KADA;AAEjBC,EAAAA,OAAO,EAAE,KAFQ;AAGjBX,EAAAA;AAHiB,CAArB;AAMA,OAAO,MAAMY,WAAW,GAAG,CAACC,KAAK,GAAGJ,YAAT,EAAuB;AAACK,EAAAA,IAAD;AAAOC,EAAAA,OAAO,GAAG;AAAjB,CAAvB,KAAkD;AACzE,UAAQD,IAAR;AACI,SAAKjB,UAAL;AACI,aAAOmB,SAAS,CAACH,KAAD,EAAQE,OAAR,CAAhB;;AACJ,SAAKjB,UAAL;AACI,aAAOmB,SAAS,CAACJ,KAAD,CAAhB;;AACJ,SAAKd,WAAL;AACI,aAAOmB,MAAM,CAACL,KAAD,CAAb;;AACJ;AACI,aAAOA,KAAP;AARR;AAUH,CAXM;;AAaP,MAAMG,SAAS,GAAG,CAACH,KAAD,EAAQE,OAAR,KAAoB;AAClC,QAAMI,QAAQ,GAAGJ,OAAO,CAACK,KAAzB;AACA,QAAMpB,IAAI,GAAGe,OAAO,CAACf,IAAR,CAAa,CAAb,CAAb;AACAqB,EAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCH,QAAlC;AACAvB,EAAAA,IAAI,CAAC2B,QAAL,CAAcC,OAAd,CAAsBC,MAAtB,CAA6B,eAA7B,IAAiD,UAASN,QAAS,EAAnE;AAEA,2BACON,KADP;AAEIH,IAAAA,eAAe,EAAE,IAFrB;AAGIV,IAAAA;AAHJ;AAKH,CAXD;;AAaA,MAAMiB,SAAS,GAAIJ,KAAD,IAAW;AACzBA,EAAAA,KAAK,qBACEA,KADF;AAEDH,IAAAA,eAAe,EAAE,CAAC,CAACW,YAAY,CAACK,OAAb,CAAqB,WAArB;AAFlB,IAAL;;AAKA,MAAIb,KAAK,CAACH,eAAV,EAA2B;AACvBd,IAAAA,IAAI,CAAC2B,QAAL,CAAcC,OAAd,CAAsBC,MAAtB,CAA6B,eAA7B,IAAiD,UAASJ,YAAY,CAACK,OAAb,CAAqB,WAArB,CAAkC,EAA5F;AACH;;AAED,SAAOb,KAAP;AACH,CAXD;;AAaA,MAAMK,MAAM,GAAIL,KAAD,IAAW;AACtBQ,EAAAA,YAAY,CAACM,UAAb,CAAwB,WAAxB;AAEA,2BACOd,KADP;AAEIH,IAAAA,eAAe,EAAE,KAFrB;AAGIV,IAAAA;AAHJ;AAKH,CARD","sourcesContent":["import RAvatar from \"../../assets/img/my_avatar.jpg\"\r\nimport {AxiosInstance as Http} from \"axios\";\r\nexport const AUTH_LOGIN = 'AUTH_LOGIN';\r\nexport const AUTH_CHECK = 'AUTH_CHECK';\r\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT';\r\n\r\nconst user = {\r\n    user_id: null,\r\n    steamid: null,\r\n    nickname: null,\r\n    avatar: null,\r\n    balance: null,\r\n    group: null,\r\n    registered_at: null,\r\n    visited_at: null,\r\n};\r\n\r\nconst initialState = {\r\n    isAuthenticated: false,\r\n    isAdmin: false,\r\n    user\r\n};\r\n\r\nexport const authReducer = (state = initialState, {type, payload = null}) => {\r\n    switch (type) {\r\n        case AUTH_LOGIN:\r\n            return authLogin(state, payload);\r\n        case AUTH_CHECK:\r\n            return checkAuth(state);\r\n        case AUTH_LOGOUT:\r\n            return logout(state);\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nconst authLogin = (state, payload) => {\r\n    const jwtToken = payload.token;\r\n    const user = payload.user[0];\r\n    localStorage.setItem('jwt_token', jwtToken);\r\n    Http.defaults.headers.common['Authorization'] = `Bearer ${jwtToken}`;\r\n\r\n    return {\r\n        ...state,\r\n        isAuthenticated: true,\r\n        user\r\n    }\r\n};\r\n\r\nconst checkAuth = (state) => {\r\n    state = {\r\n        ...state,\r\n        isAuthenticated: !!localStorage.getItem('jwt_token'),\r\n    }\r\n\r\n    if (state.isAuthenticated) {\r\n        Http.defaults.headers.common['Authorization'] = `Bearer ${localStorage.getItem('jwt_token')}`;\r\n    }\r\n\r\n    return state;\r\n};\r\n\r\nconst logout = (state) => {\r\n    localStorage.removeItem('jwt_token');\r\n\r\n    return {\r\n        ...state,\r\n        isAuthenticated: false,\r\n        user\r\n    }\r\n};"]},"metadata":{},"sourceType":"module"}