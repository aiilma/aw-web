{"ast":null,"code":"import { fetch } from \"../utils\";\nconst baseUrl = typeof document === \"undefined\" ? \"http://localhost:8000/api\" : \"/api\";\n\nconst apiService = () => next => action => {\n  const result = next(action);\n\n  if (!action.meta || !action.meta.async) {\n    return result;\n  }\n\n  console.log(action.meta);\n  const _action$meta = action.meta,\n        path = _action$meta.path,\n        _action$meta$method = _action$meta.method,\n        method = _action$meta$method === void 0 ? \"GET\" : _action$meta$method,\n        body = _action$meta.body;\n\n  if (!path) {\n    throw new Error(`'path' not specified for async action ${action.type}`);\n  }\n\n  const url = `${baseUrl}${path}`;\n  return fetch(url, method, body).then(res => handleResponse(res, action, next), err => handleErrors(err, action, next));\n};\n\nexport default apiService;\n\nfunction handleErrors(err, action, next) {\n  next({\n    type: `${action.type}_FAILED`,\n    payload: err,\n    meta: action.meta\n  });\n  return Promise.reject(err);\n}\n\nfunction handleResponse(res, action, next) {\n  next({\n    type: `${action.type}_COMPLETED`,\n    payload: res,\n    meta: action.meta\n  });\n  return res;\n}","map":{"version":3,"sources":["D:/Projects/php/Laravel/aw.client/src/store/middlewares/apiService.js"],"names":["fetch","baseUrl","document","apiService","next","action","result","meta","async","console","log","path","method","body","Error","type","url","then","res","handleResponse","err","handleErrors","payload","Promise","reject"],"mappings":"AAAA,SAAQA,KAAR,QAAoB,UAApB;AAEA,MAAMC,OAAO,GAAG,OAAOC,QAAP,KAAoB,WAApB,GAAkC,2BAAlC,GAAgE,MAAhF;;AAEA,MAAMC,UAAU,GAAG,MAAOC,IAAD,IAAWC,MAAD,IAAY;AAC3C,QAAMC,MAAM,GAAGF,IAAI,CAACC,MAAD,CAAnB;;AACA,MAAI,CAACA,MAAM,CAACE,IAAR,IAAgB,CAACF,MAAM,CAACE,IAAP,CAAYC,KAAjC,EAAwC;AACpC,WAAOF,MAAP;AACH;;AACDG,EAAAA,OAAO,CAACC,GAAR,CAAYL,MAAM,CAACE,IAAnB;AAL2C,uBAMNF,MAAM,CAACE,IAND;AAAA,QAMpCI,IANoC,gBAMpCA,IANoC;AAAA,2CAM9BC,MAN8B;AAAA,QAM9BA,MAN8B,oCAMrB,KANqB;AAAA,QAMdC,IANc,gBAMdA,IANc;;AAQ3C,MAAI,CAACF,IAAL,EAAW;AACP,UAAM,IAAIG,KAAJ,CAAW,yCAAwCT,MAAM,CAACU,IAAK,EAA/D,CAAN;AACH;;AAED,QAAMC,GAAG,GAAI,GAAEf,OAAQ,GAAEU,IAAK,EAA9B;AAEA,SAAOX,KAAK,CAACgB,GAAD,EAAMJ,MAAN,EAAcC,IAAd,CAAL,CAAyBI,IAAzB,CACHC,GAAG,IAAIC,cAAc,CAACD,GAAD,EAAMb,MAAN,EAAcD,IAAd,CADlB,EAEHgB,GAAG,IAAIC,YAAY,CAACD,GAAD,EAAMf,MAAN,EAAcD,IAAd,CAFhB,CAAP;AAIH,CAlBD;;AAoBA,eAAeD,UAAf;;AAEA,SAASkB,YAAT,CAAsBD,GAAtB,EAA2Bf,MAA3B,EAAmCD,IAAnC,EAAyC;AACrCA,EAAAA,IAAI,CAAC;AACDW,IAAAA,IAAI,EAAG,GAAEV,MAAM,CAACU,IAAK,SADpB;AAEDO,IAAAA,OAAO,EAAEF,GAFR;AAGDb,IAAAA,IAAI,EAAEF,MAAM,CAACE;AAHZ,GAAD,CAAJ;AAMA,SAAOgB,OAAO,CAACC,MAAR,CAAeJ,GAAf,CAAP;AACH;;AAED,SAASD,cAAT,CAAwBD,GAAxB,EAA6Bb,MAA7B,EAAqCD,IAArC,EAA2C;AACvCA,EAAAA,IAAI,CAAC;AACDW,IAAAA,IAAI,EAAG,GAAEV,MAAM,CAACU,IAAK,YADpB;AAEDO,IAAAA,OAAO,EAAEJ,GAFR;AAGDX,IAAAA,IAAI,EAAEF,MAAM,CAACE;AAHZ,GAAD,CAAJ;AAMA,SAAOW,GAAP;AACH","sourcesContent":["import {fetch} from \"../utils\";\r\n\r\nconst baseUrl = typeof document === \"undefined\" ? \"http://localhost:8000/api\" : \"/api\";\r\n\r\nconst apiService = () => (next) => (action) => {\r\n    const result = next(action);\r\n    if (!action.meta || !action.meta.async) {\r\n        return result;\r\n    }\r\n    console.log(action.meta)\r\n    const {path, method = \"GET\", body} = action.meta;\r\n\r\n    if (!path) {\r\n        throw new Error(`'path' not specified for async action ${action.type}`);\r\n    }\r\n\r\n    const url = `${baseUrl}${path}`;\r\n\r\n    return fetch(url, method, body).then(\r\n        res => handleResponse(res, action, next),\r\n        err => handleErrors(err, action, next),\r\n    );\r\n};\r\n\r\nexport default apiService;\r\n\r\nfunction handleErrors(err, action, next) {\r\n    next({\r\n        type: `${action.type}_FAILED`,\r\n        payload: err,\r\n        meta: action.meta,\r\n    });\r\n\r\n    return Promise.reject(err);\r\n}\r\n\r\nfunction handleResponse(res, action, next) {\r\n    next({\r\n        type: `${action.type}_COMPLETED`,\r\n        payload: res,\r\n        meta: action.meta,\r\n    });\r\n\r\n    return res;\r\n}"]},"metadata":{},"sourceType":"module"}